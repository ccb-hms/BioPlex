<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic checks of BioPlex PPI data • BioPlex</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic checks of BioPlex PPI data">
<meta property="og:description" content="BioPlex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BioPlex</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/BioPlex.html">Data retrieval</a>
</li>
<li>
  <a href="../articles/BasicChecks.html">Data checks</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ccb-hms/BioPlex">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="BasicChecks_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic checks of BioPlex PPI data</h1>
            
            <h4 class="date">13 July 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ccb-hms/BioPlex/blob/master/vignettes/BasicChecks.Rmd"><code>vignettes/BasicChecks.Rmd</code></a></small>
      <div class="hidden name"><code>BasicChecks.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ccb-hms/BioPlex">BioPlex</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/AnnotationDbi">AnnotationDbi</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">AnnotationHub</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ExpressionAtlas</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></code></pre></div>
<p>Connect to <a href="http://bioconductor.org/packages/AnnotationHub">AnnotationHub</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ah</span> <span class="op">&lt;-</span> <span class="fu">AnnotationHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationHub/man/AnnotationHub-class.html">AnnotationHub</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Connect to <a href="http://bioconductor.org/packages/ExperimentHub">ExperimentHub</a>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">eh</span> <span class="op">&lt;-</span> <span class="fu">ExperimentHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ExperimentHub/man/ExperimentHub-class.html">ExperimentHub</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>OrgDb package for human:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ahdb</span> <span class="op">&lt;-</span> <span class="fu">AnnotationHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationHub/man/AnnotationHub-class.html">query</a></span><span class="op">(</span><span class="va">ah</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"orgDb"</span>, <span class="st">"Homo sapiens"</span><span class="op">)</span><span class="op">)</span>
<span class="va">orgdb</span> <span class="op">&lt;-</span> <span class="va">ahdb</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ahdb</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>
<span class="va">orgdb</span>
<span class="co">#&gt; OrgDb object:</span>
<span class="co">#&gt; | DBSCHEMAVERSION: 2.1</span>
<span class="co">#&gt; | Db type: OrgDb</span>
<span class="co">#&gt; | Supporting package: AnnotationDbi</span>
<span class="co">#&gt; | DBSCHEMA: HUMAN_DB</span>
<span class="co">#&gt; | ORGANISM: Homo sapiens</span>
<span class="co">#&gt; | SPECIES: Human</span>
<span class="co">#&gt; | EGSOURCEDATE: 2021-Apr14</span>
<span class="co">#&gt; | EGSOURCENAME: Entrez Gene</span>
<span class="co">#&gt; | EGSOURCEURL: ftp://ftp.ncbi.nlm.nih.gov/gene/DATA</span>
<span class="co">#&gt; | CENTRALID: EG</span>
<span class="co">#&gt; | TAXID: 9606</span>
<span class="co">#&gt; | GOSOURCENAME: Gene Ontology</span>
<span class="co">#&gt; | GOSOURCEURL: http://current.geneontology.org/ontology/go-basic.obo</span>
<span class="co">#&gt; | GOSOURCEDATE: 2021-02-01</span>
<span class="co">#&gt; | GOEGSOURCEDATE: 2021-Apr14</span>
<span class="co">#&gt; | GOEGSOURCENAME: Entrez Gene</span>
<span class="co">#&gt; | GOEGSOURCEURL: ftp://ftp.ncbi.nlm.nih.gov/gene/DATA</span>
<span class="co">#&gt; | KEGGSOURCENAME: KEGG GENOME</span>
<span class="co">#&gt; | KEGGSOURCEURL: ftp://ftp.genome.jp/pub/kegg/genomes</span>
<span class="co">#&gt; | KEGGSOURCEDATE: 2011-Mar15</span>
<span class="co">#&gt; | GPSOURCENAME: UCSC Genome Bioinformatics (Homo sapiens)</span>
<span class="co">#&gt; | GPSOURCEURL: </span>
<span class="co">#&gt; | GPSOURCEDATE: 2021-Feb16</span>
<span class="co">#&gt; | ENSOURCEDATE: 2021-Feb16</span>
<span class="co">#&gt; | ENSOURCENAME: Ensembl</span>
<span class="co">#&gt; | ENSOURCEURL: ftp://ftp.ensembl.org/pub/current_fasta</span>
<span class="co">#&gt; | UPSOURCENAME: Uniprot</span>
<span class="co">#&gt; | UPSOURCEURL: http://www.UniProt.org/</span>
<span class="co">#&gt; | UPSOURCEDATE: Mon Apr 26 21:53:12 2021</span>
<span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">keytypes</a></span><span class="op">(</span><span class="va">orgdb</span><span class="op">)</span>
<span class="co">#&gt;  [1] "ACCNUM"       "ALIAS"        "ENSEMBL"      "ENSEMBLPROT"  "ENSEMBLTRANS"</span>
<span class="co">#&gt;  [6] "ENTREZID"     "ENZYME"       "EVIDENCE"     "EVIDENCEALL"  "GENENAME"    </span>
<span class="co">#&gt; [11] "GENETYPE"     "GO"           "GOALL"        "IPI"          "MAP"         </span>
<span class="co">#&gt; [16] "OMIM"         "ONTOLOGY"     "ONTOLOGYALL"  "PATH"         "PFAM"        </span>
<span class="co">#&gt; [21] "PMID"         "PROSITE"      "REFSEQ"       "SYMBOL"       "UCSCKG"      </span>
<span class="co">#&gt; [26] "UNIPROT"</span></code></pre></div>
</div>
<div id="check-identify-corum-complexes-that-have-a-subunit-of-interest" class="section level1">
<h1 class="hasAnchor">
<a href="#check-identify-corum-complexes-that-have-a-subunit-of-interest" class="anchor"></a>Check: identify CORUM complexes that have a subunit of interest</h1>
<p>Get core set of complexes:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">core</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCorum.html">getCorum</a></span><span class="op">(</span>set <span class="op">=</span> <span class="st">"core"</span>, organism <span class="op">=</span> <span class="st">"Human"</span><span class="op">)</span>
<span class="co">#&gt; Using cached version from 2021-07-13 05:24:19</span></code></pre></div>
<p>Turn the CORUM complexes into a list of graph instances, where all nodes of a complex are connected to all other nodes of that complex with undirected edges.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">core.glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/corum2graphlist.html">corum2graphlist</a></span><span class="op">(</span><span class="va">core</span>, subunit.id.type <span class="op">=</span> <span class="st">"UNIPROT"</span><span class="op">)</span></code></pre></div>
<p>Identify complexes that have a subunit of interest:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">has.cdk2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hasSubunit.html">hasSubunit</a></span><span class="op">(</span><span class="va">core.glist</span>, 
                       subunit <span class="op">=</span> <span class="st">"CDK2"</span>,
                       id.type <span class="op">=</span> <span class="st">"SYMBOL"</span><span class="op">)</span></code></pre></div>
<p>Check the answer:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">has.cdk2</span><span class="op">)</span>
<span class="co">#&gt; has.cdk2</span>
<span class="co">#&gt; FALSE  TRUE </span>
<span class="co">#&gt;  2408     9</span>
<span class="va">cdk2.glist</span> <span class="op">&lt;-</span> <span class="va">core.glist</span><span class="op">[</span><span class="va">has.cdk2</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">cdk2.glist</span>, <span class="kw">function</span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/nodeData-methods.html">nodeData</a></span><span class="op">(</span><span class="va">g</span>, attr <span class="op">=</span> <span class="st">"SYMBOL"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $CORUM311_Cell_cycle_kinase_complex_CDK2</span>
<span class="co">#&gt;   P12004   P24385   P24941   P38936 </span>
<span class="co">#&gt;   "PCNA"  "CCND1"   "CDK2" "CDKN1A" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`CORUM1003_RC_complex_(Replication_competent_complex)`</span>
<span class="co">#&gt;  P09884  P20248  P24941  P35249  P35250  P35251  P40937  P40938  Q14181 </span>
<span class="co">#&gt; "POLA1" "CCNA2"  "CDK2"  "RFC4"  "RFC2"  "RFC1"  "RFC5"  "RFC3" "POLA2" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`CORUM1004_RC_complex_during_S-phase_of_cell_cycle`</span>
<span class="co">#&gt;  P09874  P09884  P11387  P15927  P18858  P20248  P24941  P27694  P28340  P35244 </span>
<span class="co">#&gt; "PARP1" "POLA1"  "TOP1"  "RPA2"  "LIG1" "CCNA2"  "CDK2"  "RPA1" "POLD1"  "RPA3" </span>
<span class="co">#&gt;  P35250  P35251  Q07864 </span>
<span class="co">#&gt;  "RFC2"  "RFC1"  "POLE" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`CORUM1656_p27-cyclinE-CDK2_complex`</span>
<span class="co">#&gt;   P24864   P24941   P46527 </span>
<span class="co">#&gt;  "CCNE1"   "CDK2" "CDKN1B" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`CORUM3015_p27-cyclinE-Cdk2_-_Ubiquitin_E3_ligase_(SKP1A,_SKP2,_CUL1,_CKS1B,_RBX1)_complex`</span>
<span class="co">#&gt;   P24864   P24941   P46527   P61024   P62877   P63208   Q13309   Q13616 </span>
<span class="co">#&gt;  "CCNE1"   "CDK2" "CDKN1B"  "CKS1B"   "RBX1"   "SKP1"   "SKP2"   "CUL1" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`CORUM5556_CDK2-CCNA2_complex`</span>
<span class="co">#&gt;  P20248  P24941 </span>
<span class="co">#&gt; "CCNA2"  "CDK2" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`CORUM5559_CDC2-CCNA2-CDK2_complex`</span>
<span class="co">#&gt;  P06493  P20248  P24941 </span>
<span class="co">#&gt;  "CDK1" "CCNA2"  "CDK2" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`CORUM5560_CDK2-CCNE1_complex`</span>
<span class="co">#&gt;  P24864  P24941 </span>
<span class="co">#&gt; "CCNE1"  "CDK2" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`CORUM6589_E2F-1-DP-1-cyclinA-CDK2_complex`</span>
<span class="co">#&gt;  P24941  P78396  Q01094  Q14186 </span>
<span class="co">#&gt;  "CDK2" "CCNA1"  "E2F1" "TFDP1"</span></code></pre></div>
<p>We can then also inspect the graph with plotting utilities from the <a href="https://bioconductor.org/packages/Rgraphviz">Rgraphviz</a> package:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cdk2.glist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, main <span class="op">=</span> <span class="va">cdk2.glist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">graphData</span><span class="op">$</span><span class="va">ComplexName</span><span class="op">)</span></code></pre></div>
</div>
<div id="check-extract-bioplex-ppis-for-a-corum-complex" class="section level1">
<h1 class="hasAnchor">
<a href="#check-extract-bioplex-ppis-for-a-corum-complex" class="anchor"></a>Check: extract BioPlex PPIs for a CORUM complex</h1>
<p>Get the latest version of the 293T PPI network:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp.293t</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getBioPlex.html">getBioPlex</a></span><span class="op">(</span>cell.line <span class="op">=</span> <span class="st">"293T"</span>, version <span class="op">=</span> <span class="st">"3.0"</span><span class="op">)</span>
<span class="co">#&gt; Using cached version from 2021-07-13 05:24:24</span></code></pre></div>
<p>Turn the BioPlex PPI network into one big graph where bait and prey relationship are represented by directed edges from bait to prey.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp.gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bioplex2graph.html">bioplex2graph</a></span><span class="op">(</span><span class="va">bp.293t</span><span class="op">)</span></code></pre></div>
<p>Now we can also easily pull out a BioPlex subnetwork for a CORUM complex of interest:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graphNEL-class.html">nodes</a></span><span class="op">(</span><span class="va">cdk2.glist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">bp.sgr</span> <span class="op">&lt;-</span> <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/subGraph.html">subGraph</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">bp.gr</span><span class="op">)</span>
<span class="va">bp.sgr</span>
<span class="co">#&gt; A graphNEL graph with directed edges</span>
<span class="co">#&gt; Number of Nodes = 4 </span>
<span class="co">#&gt; Number of Edges = 5</span></code></pre></div>
</div>
<div id="check-identify-interacting-domains-for-a-pfam-domain-of-interest" class="section level1">
<h1 class="hasAnchor">
<a href="#check-identify-interacting-domains-for-a-pfam-domain-of-interest" class="anchor"></a>Check: identify interacting domains for a PFAM domain of interest</h1>
<p>Add PFAM domain annotations to the node metadata:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp.gr</span> <span class="op">&lt;-</span> <span class="fu">BioPlex</span><span class="fu">::</span><span class="fu"><a href="../reference/annotatePFAM.html">annotatePFAM</a></span><span class="op">(</span><span class="va">bp.gr</span>, <span class="va">orgdb</span><span class="op">)</span></code></pre></div>
<p>Create a map from PFAM to UNIPROT:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unip2pfam</span> <span class="op">&lt;-</span> <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/nodeData-methods.html">nodeData</a></span><span class="op">(</span><span class="va">bp.gr</span>, <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graphNEL-class.html">nodes</a></span><span class="op">(</span><span class="va">bp.gr</span><span class="op">)</span>, <span class="st">"PFAM"</span><span class="op">)</span>
<span class="va">pfam2unip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/stack.html">stack</a></span><span class="op">(</span><span class="va">unip2pfam</span><span class="op">)</span>
<span class="va">pfam2unip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">pfam2unip</span><span class="op">$</span><span class="va">ind</span><span class="op">)</span>, <span class="va">pfam2unip</span><span class="op">$</span><span class="va">values</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pfam2unip</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; $PF00001</span>
<span class="co">#&gt;  [1] "P28566" "P25106" "P23945" "Q9HBX9" "P16473" "P04201" "Q9HC97" "P30968"</span>
<span class="co">#&gt;  [9] "Q9Y2T6" "Q14330" "P46089" "Q15391" "Q9BXA5" "Q13304" "P61073" "P21462"</span>
<span class="co">#&gt; [17] "P25090" "Q99679" "P21730" "P30556" "P43088" "P32246" "P32249" "Q9Y2T5"</span>
<span class="co">#&gt; [25] "Q7Z602" "P43657" "O00398" "Q9H244" "Q86VZ1" "Q9NPB9" "Q99788" "P51684"</span>
<span class="co">#&gt; [33] "P35414" "O00590" "Q9H1Y3" "P55085" "O15218" "Q9GZQ4" "P25101" "Q9NS66"</span>
<span class="co">#&gt; [41] "Q9NQS5" "P21453" "P14416" "P24530" "P32239" "Q16581" "O00421" "Q9UHM6"</span>
<span class="co">#&gt; [49] "Q8N6U8" "P20309" "O15354" "Q9BXC0" "P47775" "P30550" "P49146" "P47900"</span>
<span class="co">#&gt; [57] "Q8TDU9" "P25103" "P35372" "P41597" "Q9P296" "P28335" "O95136" "P08173"</span>
<span class="co">#&gt; [65] "P29371" "P41146" "P43119" "O95977" "Q9HBW0" "Q99677" "Q9BXB1" "Q8WXD0"</span>
<span class="co">#&gt; [73] "O43193" "P30989" "Q8NGU9" "P47901" "P22888" "Q9GZN0" "P21917" "O60755"</span>
<span class="co">#&gt; [81] "Q8TDV0" "O43614" "Q9NS67" "P08912" "Q9UPC5" "Q8TDV2" "Q92633" "Q9NQ55"</span>
<span class="co">#&gt; [89] "Q13585" "Q9UBY5" "Q9H228" "P28222"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $PF00002</span>
<span class="co">#&gt;  [1] "Q8IZP9" "P41587" "Q8IZF4" "P49190" "P32241" "P47871" "P48960" "Q8IZF5"</span>
<span class="co">#&gt;  [9] "O14514" "Q03431" "Q9NYQ6" "Q9HCU4" "Q8WXG9" "Q9NYQ7" "O60242" "O60241"</span>
<span class="co">#&gt; [17] "Q9HAR2" "O94910" "Q8IWK6" "O95490" "Q96PE1" "Q86SQ4"</span></code></pre></div>
<p>Let’s focus on <a href="http://pfam.xfam.org/family/PF02023">PF02023</a>, corresponding to the zinc finger-associated SCAN domain. For each protein containing the SCAN domain, we now extract PFAM domains connected to the SCAN domain by an edge in the BioPlex network.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scan.unip</span> <span class="op">&lt;-</span> <span class="va">pfam2unip</span><span class="op">[[</span><span class="st">"PF02023"</span><span class="op">]</span><span class="op">]</span>
<span class="va">getIAPfams</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/nodeData-methods.html">nodeData</a></span><span class="op">(</span><span class="va">bp.gr</span>, <span class="fu">graph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/graph/man/graphNEL-class.html">edges</a></span><span class="op">(</span><span class="va">bp.gr</span><span class="op">)</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span>, <span class="st">"PFAM"</span><span class="op">)</span>
<span class="va">unip2iapfams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">scan.unip</span>, <span class="va">getIAPfams</span><span class="op">)</span>
<span class="va">unip2iapfams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">unip2iapfams</span>, <span class="va">unlist</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">unip2iapfams</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">scan.unip</span></code></pre></div>
<p>Looking at the top 5 PFAM domains most frequently connected to the SCAN domain by an edge in the BioPlex network …</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pfam2iapfams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">unip2iapfams</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">pfam2iapfams</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>
<span class="co">#&gt; pfam2iapfams</span>
<span class="co">#&gt; PF02023 PF00096 PF01352 PF06467 PF00249 </span>
<span class="co">#&gt;     208     169      99      14       8</span></code></pre></div>
<p>… we find <a href="http://pfam.xfam.org/family/PF02023">PF02023</a>, the SCAN domain itself, and <a href="http://pfam.xfam.org/family/PF00096">PF00096</a>, a C2H2 type zinc finger domain. This finding is consistent with results reported in the <a href="https://doi.org/10.1016/j.cell.2021.04.011">BioPlex 3.0 publication</a>.</p>
<p>See also the <a href="https://ccb-hms.github.io/BioPlexAnalysis/articles/PFAM.html">PFAM domain-domain association analysis vignette</a> for a more comprehensive analysis of PFAM domain associations in the BioPlex network.</p>
</div>
<div id="check-expressed-genes-are-showing-up-as-prey-293t-cells" class="section level1">
<h1 class="hasAnchor">
<a href="#check-expressed-genes-are-showing-up-as-prey-293t-cells" class="anchor"></a>Check: expressed genes are showing up as prey (293T cells)</h1>
<p>Get RNA-seq data for HEK293 cells from GEO: <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE122425">GSE122425</a></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getGSE122425.html">getGSE122425</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Using cached version from 2021-07-13 05:24:36</span>
<span class="va">se</span>
<span class="co">#&gt; class: SummarizedExperiment </span>
<span class="co">#&gt; dim: 57905 6 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(2): raw rpkm</span>
<span class="co">#&gt; rownames(57905): ENSG00000223972 ENSG00000227232 ... ENSG00000231514</span>
<span class="co">#&gt;   ENSG00000235857</span>
<span class="co">#&gt; rowData names(4): SYMBOL KO GO length</span>
<span class="co">#&gt; colnames(6): GSM3466389 GSM3466390 ... GSM3466393 GSM3466394</span>
<span class="co">#&gt; colData names(41): title geo_accession ... passages.ch1 strain.ch1</span></code></pre></div>
<p>Inspect expression of prey genes:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bait</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">bp.293t</span><span class="op">$</span><span class="va">SymbolA</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">bait</span><span class="op">)</span>
<span class="co">#&gt; [1] 8995</span>
<span class="va">prey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">bp.293t</span><span class="op">$</span><span class="va">SymbolB</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">prey</span><span class="op">)</span>
<span class="co">#&gt; [1] 10419</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">prey</span>, <span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">SYMBOL</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>las <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">se</span>, <span class="st">"rpkm"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span>, 
        names <span class="op">=</span> <span class="va">se</span><span class="op">$</span><span class="va">title</span>, 
        ylab <span class="op">=</span> <span class="st">"log2 RPKM"</span><span class="op">)</span></code></pre></div>
<p><img src="BasicChecks_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>How many prey genes are expressed (raw read count &gt; 0) in all 3 WT reps:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># background: how many genes in total are expressed in all three WT reps</span>
<span class="va">gr0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">gr0</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; FALSE  TRUE </span>
<span class="co">#&gt; 33842 24063</span>
<span class="co"># prey: expressed in all three WT reps</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">gr0</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; FALSE  TRUE </span>
<span class="co">#&gt;   599  9346</span>
<span class="co"># prey: expressed in at least one WT rep</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">gr0</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; FALSE  TRUE </span>
<span class="co">#&gt;   305  9640</span></code></pre></div>
<p>Are prey genes overrepresented in the expressed genes?</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exprTable</span> <span class="op">&lt;-</span>
     <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9346</span>, <span class="fl">1076</span>, <span class="fl">14717</span>, <span class="fl">32766</span><span class="op">)</span>,
            nrow <span class="op">=</span> <span class="fl">2</span>,
            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Expressed"</span>, <span class="st">"Not.expressed"</span><span class="op">)</span>,
                            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"In.prey.set"</span>, <span class="st">"Not.in.prey.set"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">exprTable</span>
<span class="co">#&gt;               In.prey.set Not.in.prey.set</span>
<span class="co">#&gt; Expressed            9346           14717</span>
<span class="co">#&gt; Not.expressed        1076           32766</span></code></pre></div>
<p>Test using hypergeometric test (i.e. one-sided Fisher’s exact test):</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">exprTable</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Fisher's Exact Test for Count Data</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  exprTable</span>
<span class="co">#&gt; p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: true odds ratio is greater than 1</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  18.29105      Inf</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; odds ratio </span>
<span class="co">#&gt;   19.34726</span></code></pre></div>
<p>Alternatively: permutation test, i.e. repeatedly sample number of prey genes from the background, and assess how often we have as many or more than 9346 genes expressed:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">permgr0</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gr0</span>, <span class="va">nr.genes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">prey</span><span class="op">)</span><span class="op">)</span> 
<span class="op">{</span>
    <span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">gr0</span><span class="op">)</span>, <span class="va">nr.genes</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">gr0</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">perms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fu">permgr0</span><span class="op">(</span><span class="va">gr0</span><span class="op">)</span>, <span class="fl">1000</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">perms</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;    1000    1000    1000    1000    1000    1000</span>
<span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">perms</span> <span class="op">&gt;=</span> <span class="fl">9346</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1001</span>
<span class="co">#&gt; [1] 0.000999001</span></code></pre></div>
</div>
<div id="check-is-there-a-relationship-between-prey-frequency-and-prey-expression-level" class="section level1">
<h1 class="hasAnchor">
<a href="#check-is-there-a-relationship-between-prey-frequency-and-prey-expression-level" class="anchor"></a>Check: is there a relationship between prey frequency and prey expression level?</h1>
<p>Check which genes turn up most frequently as prey:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prey.freq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bp.293t</span><span class="op">$</span><span class="va">SymbolB</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">preys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">prey.freq</span><span class="op">)</span>
<span class="va">prey.freq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">prey.freq</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">prey.freq</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">preys</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">prey.freq</span><span class="op">)</span>
<span class="co">#&gt; HSPA5 HSPA8 TUBB8   UBB  YBX1 YWHAH </span>
<span class="co">#&gt;   199   192   176   173   139   132</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">prey.freq</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;    1.00    2.00    6.00   11.34   16.00  199.00</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">prey.freq</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">"Number of PPIs"</span>, ylab <span class="op">=</span> <span class="st">"Number of genes"</span><span class="op">)</span></code></pre></div>
<p><img src="BasicChecks_files/figure-html/prey-freq-1.png" width="700"></p>
<p>Prey genes are involved 11 PPIs on average.</p>
<p>There doesn’t seem to be a strong correlation between expression level and the frequency of gene to turn up as prey:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">prey.freq</span><span class="op">)</span>, <span class="fu">rowData</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">SYMBOL</span><span class="op">)</span>
<span class="va">rmeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">se</span>, <span class="st">"rpkm"</span><span class="op">)</span><span class="op">[</span><span class="va">ind</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>
<span class="va">log.rmeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">rmeans</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span> x <span class="op">=</span> <span class="va">prey.freq</span>,
      y <span class="op">=</span> <span class="va">log.rmeans</span>,
      xlab <span class="op">=</span> <span class="st">"prey frequency"</span>,
      ylab <span class="op">=</span> <span class="st">"log2 RPKM"</span><span class="op">)</span></code></pre></div>
<p><img src="BasicChecks_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">prey.freq</span>, 
    <span class="va">log.rmeans</span>,
    use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.2035977</span></code></pre></div>
<p>See also the <a href="https://ccb-hms.github.io/BioPlexAnalysis/articles/BioNet.html">BioNet maximum scoring subnetwork analysis vignette</a> for a more comprehensive analysis of the 293T transcriptome data from GSE122425 when mapped onto BioPlex PPI network.</p>
</div>
<div id="check-expressed-genes-are-showing-up-as-prey-hct116-cells" class="section level1">
<h1 class="hasAnchor">
<a href="#check-expressed-genes-are-showing-up-as-prey-hct116-cells" class="anchor"></a>Check: expressed genes are showing up as prey (HCT116 cells)</h1>
<p>Get the latest version of the HCT116 PPI network:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp.hct116</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getBioPlex.html">getBioPlex</a></span><span class="op">(</span>cell.line <span class="op">=</span> <span class="st">"HCT116"</span>, version <span class="op">=</span> <span class="st">"1.0"</span><span class="op">)</span>
<span class="co">#&gt; Using cached version from 2021-07-13 05:24:40</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bp.hct116</span><span class="op">)</span>
<span class="co">#&gt;   GeneA  GeneB UniprotA UniprotB  SymbolA SymbolB           pW          pNI</span>
<span class="co">#&gt; 1 88455  50649   Q8IZ07 Q9NR80-4 ANKRD13A ARHGEF4 3.959215e-04 3.298003e-05</span>
<span class="co">#&gt; 2 88455 115106   Q8IZ07   Q96CS2 ANKRD13A   HAUS1 4.488473e-02 1.934731e-03</span>
<span class="co">#&gt; 3 88455  23086   Q8IZ07 Q8NEV8-2 ANKRD13A   EXPH5 7.402394e-05 9.296226e-04</span>
<span class="co">#&gt; 4 88455  54930   Q8IZ07   Q9H6D7 ANKRD13A   HAUS4 9.180959e-07 1.278318e-04</span>
<span class="co">#&gt; 5 88455  79441   Q8IZ07   Q68CZ6 ANKRD13A   HAUS3 8.709394e-07 1.495480e-03</span>
<span class="co">#&gt; 6 88455  93323   Q8IZ07 Q9BT25-2 ANKRD13A   HAUS8 9.147659e-06 2.061483e-03</span>
<span class="co">#&gt;        pInt</span>
<span class="co">#&gt; 1 0.9995711</span>
<span class="co">#&gt; 2 0.9531805</span>
<span class="co">#&gt; 3 0.9989964</span>
<span class="co">#&gt; 4 0.9998713</span>
<span class="co">#&gt; 5 0.9985036</span>
<span class="co">#&gt; 6 0.9979294</span></code></pre></div>
<p>Get RNA-seq data for 934 cancer cell lines (incl. HCT116) from the <a href="https://portals.broadinstitute.org/ccle">Cancer Cell Line Encyclopedia</a> as available from the <a href="https://www.ebi.ac.uk/gxa">ArrayExpress-ExpressionAtlas</a> (Accession: <a href="https://www.ebi.ac.uk/gxa/experiments/E-MTAB-2770">E-MTAB-2770</a>)</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">atlasRes</span> <span class="op">&lt;-</span> <span class="fu">ExpressionAtlas</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ExpressionAtlas/man/searchAtlasExperiments.html">searchAtlasExperiments</a></span><span class="op">(</span>
              properties <span class="op">=</span> <span class="st">"Cancer Cell Line Encyclopedia"</span>, 
              species <span class="op">=</span> <span class="st">"human"</span> <span class="op">)</span>
<span class="co">#&gt; Searching for Expression Atlas experiments matching your query ...</span>
<span class="co">#&gt; Query successful.</span>
<span class="co">#&gt; Found 1 experiments matching your query.</span>
<span class="va">atlasRes</span>
<span class="co">#&gt; DataFrame with 1 row and 4 columns</span>
<span class="co">#&gt;     Accession      Species                  Type                  Title</span>
<span class="co">#&gt;   &lt;character&gt;  &lt;character&gt;           &lt;character&gt;            &lt;character&gt;</span>
<span class="co">#&gt; 1 E-MTAB-2770 Homo sapiens RNA-seq of coding RNA RNA-seq of 934 human..</span>
<span class="va">ccle</span> <span class="op">&lt;-</span> <span class="fu">ExpressionAtlas</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ExpressionAtlas/man/getAtlasData.html">getAtlasData</a></span><span class="op">(</span><span class="va">atlasRes</span><span class="op">$</span><span class="va">Accession</span><span class="op">)</span>
<span class="co">#&gt; Downloading Expression Atlas experiment summary from:</span>
<span class="co">#&gt;  ftp://ftp.ebi.ac.uk/pub/databases/microarray/data/atlas/experiments/E-MTAB-2770/E-MTAB-2770-atlasExperimentSummary.Rdata</span>
<span class="co">#&gt; Successfully downloaded experiment summary object for E-MTAB-2770</span>
<span class="va">ccle</span> <span class="op">&lt;-</span> <span class="va">ccle</span><span class="op">$</span><span class="va">`E-MTAB-2770`</span><span class="op">$</span><span class="va">rnaseq</span>
<span class="va">ccle</span>
<span class="co">#&gt; class: RangedSummarizedExperiment </span>
<span class="co">#&gt; dim: 65217 934 </span>
<span class="co">#&gt; metadata(4): pipeline filtering mapping quantification</span>
<span class="co">#&gt; assays(1): counts</span>
<span class="co">#&gt; rownames(65217): ENSG00000000003 ENSG00000000005 ... ENSG00000281921</span>
<span class="co">#&gt;   ENSG00000281922</span>
<span class="co">#&gt; rowData names(0):</span>
<span class="co">#&gt; colnames(934): run_22Rv1.2 run_23132_87.2 ... run_ZR_75_1.1</span>
<span class="co">#&gt;   run_ZR_75_30.1</span>
<span class="co">#&gt; colData names(4): AtlasAssayGroup organism cell_line disease</span></code></pre></div>
<p>Get RNA-seq data of 675 commonly used human cancer cell lines (incl. HCT116) from <a href="https://pubmed.ncbi.nlm.nih.gov/25485619">Klijn et al., 2015</a> as available from the <a href="https://www.ebi.ac.uk/gxa">ArrayExpress-ExpressionAtlas</a> (Accession: <a href="https://www.ebi.ac.uk/gxa/experiments/E-MTAB-2706">E-MTAB-2706</a>)</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">klijn</span> <span class="op">&lt;-</span> <span class="fu">ExpressionAtlas</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ExpressionAtlas/man/getAtlasData.html">getAtlasData</a></span><span class="op">(</span><span class="st">"E-MTAB-2706"</span><span class="op">)</span>
<span class="co">#&gt; Downloading Expression Atlas experiment summary from:</span>
<span class="co">#&gt;  ftp://ftp.ebi.ac.uk/pub/databases/microarray/data/atlas/experiments/E-MTAB-2706/E-MTAB-2706-atlasExperimentSummary.Rdata</span>
<span class="co">#&gt; Successfully downloaded experiment summary object for E-MTAB-2706</span>
<span class="va">klijn</span> <span class="op">&lt;-</span> <span class="va">klijn</span><span class="op">$</span><span class="va">`E-MTAB-2706`</span><span class="op">$</span><span class="va">rnaseq</span>
<span class="va">klijn</span>
<span class="co">#&gt; class: RangedSummarizedExperiment </span>
<span class="co">#&gt; dim: 65217 622 </span>
<span class="co">#&gt; metadata(4): pipeline filtering mapping quantification</span>
<span class="co">#&gt; assays(1): counts</span>
<span class="co">#&gt; rownames(65217): ENSG00000000003 ENSG00000000005 ... ENSG00000281921</span>
<span class="co">#&gt;   ENSG00000281922</span>
<span class="co">#&gt; rowData names(0):</span>
<span class="co">#&gt; colnames(622): ERR413347 ERR413348 ... ERR414020 ERR415514</span>
<span class="co">#&gt; colData names(12): AtlasAssayGroup organism ... media freeze_media</span></code></pre></div>
<p>Sanity check that the expressed genes are showing up as prey:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bait</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">bp.hct116</span><span class="op">$</span><span class="va">GeneA</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">bait</span><span class="op">)</span>
<span class="co">#&gt; [1] 4866</span>
<span class="va">prey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">bp.hct116</span><span class="op">$</span><span class="va">GeneB</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">prey</span><span class="op">)</span>
<span class="co">#&gt; [1] 7903</span></code></pre></div>
<p>Map prey to ENSEMBL gene IDs:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prey</span> <span class="op">&lt;-</span> <span class="fu">AnnotationDbi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">mapIds</a></span><span class="op">(</span><span class="va">orgdb</span>, 
                              keytype <span class="op">=</span> <span class="st">"ENTREZID"</span>, 
                              column <span class="op">=</span> <span class="st">"ENSEMBL"</span>,
                              keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">prey</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; 'select()' returned 1:many mapping between keys and columns</span>
<span class="va">prey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="va">prey</span><span class="op">)</span><span class="op">)</span>
<span class="va">ind.prey</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">prey</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">ccle</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Combine HCT-116 transcriptome from CCLE and Klijn et al. datasets:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ind1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"HCT 116"</span>, <span class="va">ccle</span><span class="op">$</span><span class="va">cell_line</span><span class="op">)</span>
<span class="va">ind2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"HCT 116"</span>, <span class="va">klijn</span><span class="op">$</span><span class="va">cell_line</span><span class="op">)</span>
<span class="va">emat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">ccle</span><span class="op">)</span><span class="op">[</span>,<span class="va">ind1</span><span class="op">]</span>, <span class="fu">assay</span><span class="op">(</span><span class="va">klijn</span><span class="op">)</span><span class="op">[</span>,<span class="va">ind2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-toTable.html">colnames</a></span><span class="op">(</span><span class="va">emat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ccle"</span>, <span class="st">"klijn"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">emat</span><span class="op">)</span>
<span class="co">#&gt;                 ccle klijn</span>
<span class="co">#&gt; ENSG00000000003 2471  1876</span>
<span class="co">#&gt; ENSG00000000005    0     0</span>
<span class="co">#&gt; ENSG00000000419 4082  3731</span>
<span class="co">#&gt; ENSG00000000457 1160   676</span>
<span class="co">#&gt; ENSG00000000460 1785  1206</span>
<span class="co">#&gt; ENSG00000000938    0     0</span></code></pre></div>
<p>The CCLE and Klijn et al. measurements correlate very well:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">emat</span><span class="op">[</span>,<span class="st">"ccle"</span><span class="op">]</span>, <span class="va">emat</span><span class="op">[</span>,<span class="st">"klijn"</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.9246789</span></code></pre></div>
<p>How many prey genes are expressed (raw read count &gt; 0) in both CCLE and Klijn et al.?</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># background: how many genes in total are expressed in both measurements</span>
<span class="va">gr0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">emat</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">gr0</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; FALSE  TRUE </span>
<span class="co">#&gt; 38752 26465</span>
<span class="co"># prey: expressed in both measurements</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">gr0</span><span class="op">[</span><span class="va">ind.prey</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; FALSE  TRUE </span>
<span class="co">#&gt;   310  7553</span>
<span class="co"># prey: expressed in at least one measurement</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">gr0</span><span class="op">[</span><span class="va">ind.prey</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; FALSE  TRUE </span>
<span class="co">#&gt;   178  7685</span></code></pre></div>
</div>
<div id="check-correlation-of-ccle-transcriptome-and-proteome-data-for-hct116" class="section level1">
<h1 class="hasAnchor">
<a href="#check-correlation-of-ccle-transcriptome-and-proteome-data-for-hct116" class="anchor"></a>Check: correlation of CCLE transcriptome and proteome data for HCT116</h1>
<p>Get the CCLE transcriptome data for HCT116:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"^HCT 116$"</span>, <span class="va">ccle</span><span class="op">$</span><span class="va">cell_line</span><span class="op">)</span>
<span class="va">ccle.trans</span> <span class="op">&lt;-</span> <span class="va">ccle</span><span class="op">[</span>,<span class="va">ind</span><span class="op">]</span>       
<span class="va">ccle.trans</span>
<span class="co">#&gt; class: RangedSummarizedExperiment </span>
<span class="co">#&gt; dim: 65217 1 </span>
<span class="co">#&gt; metadata(4): pipeline filtering mapping quantification</span>
<span class="co">#&gt; assays(1): counts</span>
<span class="co">#&gt; rownames(65217): ENSG00000000003 ENSG00000000005 ... ENSG00000281921</span>
<span class="co">#&gt;   ENSG00000281922</span>
<span class="co">#&gt; rowData names(0):</span>
<span class="co">#&gt; colnames(1): run_HCT_116.2</span>
<span class="co">#&gt; colData names(4): AtlasAssayGroup organism cell_line disease</span></code></pre></div>
<p>We would typically convert the raw counts to FPKMs or TPMs to account for gene length, but here we just do a simple log-transformation of the counts divided by library size.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu">assay</span><span class="op">(</span><span class="va">ccle.trans</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>
<span class="fu">assay</span><span class="op">(</span><span class="va">ccle.trans</span>, <span class="st">"logcounts"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">a1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">a1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1e6</span><span class="op">)</span></code></pre></div>
<p>Get the CCLE proteome data for HCT116:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ehdb</span> <span class="op">&lt;-</span> <span class="fu">AnnotationHub</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationHub/man/AnnotationHub-class.html">query</a></span><span class="op">(</span><span class="va">eh</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gygi"</span>, <span class="st">"depmap"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ccle.prot</span> <span class="op">&lt;-</span> <span class="va">ehdb</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ehdb</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt; snapshotDate(): 2021-05-18</span>
<span class="co">#&gt; see ?depmap and browseVignettes('depmap') for documentation</span>
<span class="co">#&gt; loading from cache</span>
<span class="va">ccle.prot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">ccle.prot</span><span class="op">)</span>
<span class="va">ccle.prot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ccleProteome2SummarizedExperiment.html">ccleProteome2SummarizedExperiment</a></span><span class="op">(</span><span class="va">ccle.prot</span>, cell.line <span class="op">=</span> <span class="st">"HCT116"</span><span class="op">)</span>
<span class="va">ccle.prot</span>
<span class="co">#&gt; class: SummarizedExperiment </span>
<span class="co">#&gt; dim: 12755 1 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(1): expr</span>
<span class="co">#&gt; rownames(12755): P55011 P35453 ... Q99735 Q9P003</span>
<span class="co">#&gt; rowData names(2): SYMBOL ENTREZID</span>
<span class="co">#&gt; colnames(1): HCT116</span>
<span class="co">#&gt; colData names(0):</span></code></pre></div>
<p>Map to ENSEMBL for comparison with CCLE transcriptome data for HCT116:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rnames</span> <span class="op">&lt;-</span> <span class="fu">AnnotationDbi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html">mapIds</a></span><span class="op">(</span><span class="va">orgdb</span>,
                      keytype <span class="op">=</span> <span class="st">"UNIPROT"</span>,
                      column <span class="op">=</span> <span class="st">"ENSEMBL"</span>,
                      keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">ccle.prot</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Subset to the ENSEMBL IDs that both datasets have in common:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">isect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">intersect</a></span><span class="op">(</span><span class="va">rnames</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">ccle.trans</span><span class="op">)</span><span class="op">)</span>
<span class="va">ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">isect</span>, <span class="va">rnames</span><span class="op">)</span></code></pre></div>
<p>A look at general correlation between HCT116 transcript and protein expression:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">ccle.trans</span>, <span class="st">"logcounts"</span><span class="op">)</span><span class="op">[</span><span class="va">isect</span>,<span class="op">]</span>, 
         <span class="fu">assay</span><span class="op">(</span><span class="va">ccle.prot</span><span class="op">)</span><span class="op">[</span><span class="va">ind</span>,<span class="op">]</span>,
         use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pearson's product-moment correlation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  assay(ccle.trans, "logcounts")[isect, ] and assay(ccle.prot)[ind, ]</span>
<span class="co">#&gt; t = 31.872, df = 7848, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: true correlation is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.3187947 0.3579705</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;       cor </span>
<span class="co">#&gt; 0.3385293</span></code></pre></div>
<p>See also the <a href="https://ccb-hms.github.io/BioPlexAnalysis/articles/TranscriptomeProteome.html">Transcriptome-Proteome analysis vignette</a> for further exploration of the correlation between HCT116 transcript and protein expression.</p>
</div>
<div id="check-differential-protein-expression-hek293-vs--hct116" class="section level1">
<h1 class="hasAnchor">
<a href="#check-differential-protein-expression-hek293-vs--hct116" class="anchor"></a>Check: differential protein expression (HEK293 vs. HCT116)</h1>
<p>Get the relative protein expression data comparing 293T and HCT116 cells from Supplementary Table S4A of the BioPlex 3 paper:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp.prot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getBioplexProteome.html">getBioplexProteome</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Using cached version from 2021-07-13 05:26:01</span>
<span class="va">bp.prot</span>
<span class="co">#&gt; class: SummarizedExperiment </span>
<span class="co">#&gt; dim: 9604 10 </span>
<span class="co">#&gt; metadata(0):</span>
<span class="co">#&gt; assays(1): exprs</span>
<span class="co">#&gt; rownames(9604): P0CG40 Q8IXZ3-4 ... Q9H3S5 Q8WYQ3</span>
<span class="co">#&gt; rowData names(5): ENTREZID SYMBOL nr.peptides log2ratio adj.pvalue</span>
<span class="co">#&gt; colnames(10): HCT1 HCT2 ... HEK4 HEK5</span>
<span class="co">#&gt; colData names(1): cell.line</span>
<span class="fu">rowData</span><span class="op">(</span><span class="va">bp.prot</span><span class="op">)</span>
<span class="co">#&gt; DataFrame with 9604 rows and 5 columns</span>
<span class="co">#&gt;             ENTREZID      SYMBOL nr.peptides log2ratio  adj.pvalue</span>
<span class="co">#&gt;          &lt;character&gt; &lt;character&gt;   &lt;integer&gt; &lt;numeric&gt;   &lt;numeric&gt;</span>
<span class="co">#&gt; P0CG40     100131390         SP9           1 -2.819071 6.66209e-08</span>
<span class="co">#&gt; Q8IXZ3-4      221833         SP8           3 -3.419888 6.94973e-07</span>
<span class="co">#&gt; P55011          6558     SLC12A2           4  0.612380 4.85602e-06</span>
<span class="co">#&gt; O60341         23028       KDM1A           7 -0.319695 5.08667e-04</span>
<span class="co">#&gt; O14654          8471        IRS4           4 -5.951096 1.45902e-06</span>
<span class="co">#&gt; ...              ...         ...         ...       ...         ...</span>
<span class="co">#&gt; Q9H6X4         80194     TMEM134           2 -0.379342 7.67195e-05</span>
<span class="co">#&gt; Q9BS91         55032     SLC35A5           1 -2.237634 8.75523e-05</span>
<span class="co">#&gt; Q9UKJ5         26511       CHIC2           1 -0.614932 1.78756e-03</span>
<span class="co">#&gt; Q9H3S5         93183        PIGM           1 -1.011397 8.91589e-06</span>
<span class="co">#&gt; Q8WYQ3        400916     CHCHD10           1  0.743852 1.17163e-03</span></code></pre></div>
<p>A couple of quick sanity checks:</p>
<ol style="list-style-type: decimal">
<li>The relative abundances are scaled to sum up to 100% for each protein:</li>
</ol>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">bp.prot</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span> 
<span class="co">#&gt;    P0CG40  Q8IXZ3-4    P55011    O60341    O14654 </span>
<span class="co">#&gt;  99.99994  99.99991  99.99996 100.00011 100.00006</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>The <code>rowData</code> column <code>log2ratio</code> corresponds to the mean of the five HEK samples, divided by the mean of the five HCT samples (and then taking log2 of it):</li>
</ol>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">bp.prot</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">bp.prot</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">ratio</span><span class="op">)</span>
<span class="co">#&gt;     P0CG40   Q8IXZ3-4     P55011     O60341     O14654 </span>
<span class="co">#&gt; -2.8190710 -3.4198879  0.6123799 -0.3196953 -5.9510960</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>The <code>rowData</code> column <code>adj.pvalue</code> stores Benjamini-Hochberg adjusted <em>p</em>-values from a <em>t</em>-test between the five HEK samples and the five HCT samples:</li>
</ol>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="fu">assay</span><span class="op">(</span><span class="va">bp.prot</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, <span class="fu">assay</span><span class="op">(</span><span class="va">bp.prot</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  assay(bp.prot)[1, 1:5] and assay(bp.prot)[1, 6:10]</span>
<span class="co">#&gt; t = -27.898, df = 7.5779, p-value = 6.482e-09</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -16.29035 -13.78047</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x mean of y </span>
<span class="co">#&gt;  2.482288 17.517700</span></code></pre></div>
<p>The <a href="https://ccb-hms.github.io/BioPlexAnalysis/articles/TranscriptomeProteome.html">Transcriptome-Proteome analysis vignette</a> also explores the agreement between differential gene expression and differential protein expression when comparing HEK293 against HCT116 cells.</p>
</div>
<div id="sessioninfo" class="section level1">
<h1 class="hasAnchor">
<a href="#sessioninfo" class="anchor"></a>SessionInfo</h1>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.1.0 (2021-05-18)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 20.04.2 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] parallel  stats4    stats     graphics  grDevices utils     datasets </span>
<span class="co">#&gt; [8] methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt;  [1] depmap_1.6.0                dplyr_1.0.7                </span>
<span class="co">#&gt;  [3] graph_1.70.0                ExpressionAtlas_1.20.0     </span>
<span class="co">#&gt;  [5] xml2_1.3.2                  limma_3.48.1               </span>
<span class="co">#&gt;  [7] AnnotationHub_3.0.1         BiocFileCache_2.0.0        </span>
<span class="co">#&gt;  [9] dbplyr_2.1.1                AnnotationDbi_1.54.1       </span>
<span class="co">#&gt; [11] BioPlex_0.99.2              SummarizedExperiment_1.22.0</span>
<span class="co">#&gt; [13] Biobase_2.52.0              GenomicRanges_1.44.0       </span>
<span class="co">#&gt; [15] GenomeInfoDb_1.28.1         IRanges_2.26.0             </span>
<span class="co">#&gt; [17] S4Vectors_0.30.0            BiocGenerics_0.38.0        </span>
<span class="co">#&gt; [19] MatrixGenerics_1.4.0        matrixStats_0.59.0         </span>
<span class="co">#&gt; [21] BiocStyle_2.20.2           </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] bitops_1.0-7                  fs_1.5.0                     </span>
<span class="co">#&gt;  [3] bit64_4.0.5                   filelock_1.0.2               </span>
<span class="co">#&gt;  [5] httr_1.4.2                    rprojroot_2.0.2              </span>
<span class="co">#&gt;  [7] tools_4.1.0                   bslib_0.2.5.1                </span>
<span class="co">#&gt;  [9] utf8_1.2.1                    R6_2.5.0                     </span>
<span class="co">#&gt; [11] DBI_1.1.1                     withr_2.4.2                  </span>
<span class="co">#&gt; [13] tidyselect_1.1.1              bit_4.0.4                    </span>
<span class="co">#&gt; [15] curl_4.3.2                    compiler_4.1.0               </span>
<span class="co">#&gt; [17] textshaping_0.3.5             desc_1.3.0                   </span>
<span class="co">#&gt; [19] DelayedArray_0.18.0           bookdown_0.22                </span>
<span class="co">#&gt; [21] sass_0.4.0                    rappdirs_0.3.3               </span>
<span class="co">#&gt; [23] pkgdown_1.6.1                 systemfonts_1.0.2            </span>
<span class="co">#&gt; [25] stringr_1.4.0                 digest_0.6.27                </span>
<span class="co">#&gt; [27] rmarkdown_2.9                 XVector_0.32.0               </span>
<span class="co">#&gt; [29] pkgconfig_2.0.3               htmltools_0.5.1.1            </span>
<span class="co">#&gt; [31] highr_0.9                     fastmap_1.1.0                </span>
<span class="co">#&gt; [33] rlang_0.4.11                  RSQLite_2.2.7                </span>
<span class="co">#&gt; [35] shiny_1.6.0                   jquerylib_0.1.4              </span>
<span class="co">#&gt; [37] generics_0.1.0                jsonlite_1.7.2               </span>
<span class="co">#&gt; [39] RCurl_1.98-1.3                magrittr_2.0.1               </span>
<span class="co">#&gt; [41] GenomeInfoDbData_1.2.6        Matrix_1.3-3                 </span>
<span class="co">#&gt; [43] Rcpp_1.0.7                    fansi_0.5.0                  </span>
<span class="co">#&gt; [45] lifecycle_1.0.0               stringi_1.6.2                </span>
<span class="co">#&gt; [47] yaml_2.2.1                    zlibbioc_1.38.0              </span>
<span class="co">#&gt; [49] grid_4.1.0                    blob_1.2.1                   </span>
<span class="co">#&gt; [51] promises_1.2.0.1              ExperimentHub_2.0.0          </span>
<span class="co">#&gt; [53] crayon_1.4.1                  lattice_0.20-44              </span>
<span class="co">#&gt; [55] Biostrings_2.60.1             KEGGREST_1.32.0              </span>
<span class="co">#&gt; [57] knitr_1.33                    pillar_1.6.1                 </span>
<span class="co">#&gt; [59] XML_3.99-0.6                  glue_1.4.2                   </span>
<span class="co">#&gt; [61] BiocVersion_3.13.1            evaluate_0.14                </span>
<span class="co">#&gt; [63] BiocManager_1.30.16           png_0.1-7                    </span>
<span class="co">#&gt; [65] vctrs_0.3.8                   httpuv_1.6.1                 </span>
<span class="co">#&gt; [67] purrr_0.3.4                   assertthat_0.2.1             </span>
<span class="co">#&gt; [69] cachem_1.0.5                  xfun_0.24                    </span>
<span class="co">#&gt; [71] mime_0.11                     xtable_1.8-4                 </span>
<span class="co">#&gt; [73] later_1.2.0                   ragg_1.1.3                   </span>
<span class="co">#&gt; [75] tibble_3.1.2                  memoise_2.0.0                </span>
<span class="co">#&gt; [77] ellipsis_0.3.2                interactiveDisplayBase_1.30.0</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ludwig Geistlinger, Robert Gentleman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
